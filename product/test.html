<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="../src/css/main.css" />
    <link rel="stylesheet" href="../src/css/products.css" />
    <style>
      .otherProduct {
        display: flex;
        background-color: #fdfaf3;
        /* height: 100vh;
        height: 100svh; */
        font-size: clamp(0.6rem, 1vw, 100rem);
      }
      .otherProduct > h3 {
        text-align: center;
        writing-mode: vertical-rl;
        font-size: clamp(2rem, 4vw, 100rem);
        font-weight: 900;
        padding: 0 4vmin;
        background-color: #fdfaf3;
      }
      .otherProduct .category {
        display: flex;
        justify-content: space-around;
        width: max-content;
        cursor: grab;
        user-select: none;
        transition: transform 0.3s ease-out;
      }

      .otherProduct .product {
        display: flex;
        flex-direction: column;
        justify-content: space-around;
        align-items: center;
        height: 80vh;
        padding: 4vmin;
        margin: 10vmin 1.5vmin;
        /* width: 20vw; */
      }
      .otherProduct .product:nth-child(1) {
        background: #e9e5db;
      }
      .otherProduct .product > div {
        padding: 1.5vmin 3vmin;
        position: relative;
      }
      .otherProduct .product > div > * {
        position: relative;
        z-index: 1;
      }
      .otherProduct .product > div::before {
        content: "";
        background-color: #ffce47;
        position: absolute;
        top: 0;
        bottom: 0;
        right: 0;
        left: 0;
        clip-path: polygon(2% 0, 100% 0%, 98% 100%, 0% 100%);
      }
      .otherProduct .product > div > h3:first-child {
        font-family: "Montserrat";
      }
      .otherProduct .product img {
        width: 45vmin;
        height: 45vmin;
        border-radius: 100vmax;
      }

      @media only screen and (max-width: 992px) {
        .otherProduct {
          flex-direction: column;
        }
        .otherProduct > h3 {
          text-align: start;
          writing-mode: unset;
        }
        .otherProduct .category {
          flex-wrap: wrap;
          width: 100%;
          max-height: 100svh;
          flex-basis: 30%;
        }
        .otherProduct .product {
          width: 45%;
          height: fit-content;
        }
        .otherProduct .product > div::before {
          background-color: transparent;
          clip-path: polygon(0% 0, 100% 0%, 100% 100%, 0% 100%);
        }
        .otherProduct .product img {
          width: 30vmin;
          height: 30vmin;
        }
        .otherProduct .product {
          margin: 0vmin;
        }
      }
    </style>
  </head>
  <body>
    <main>
      <div class="otherProduct">
        <h3>دیگر محصولات</h3>
        <div id="products-container" class="category"></div>
      </div>
      <div class="scroll-bar" id="scroll-bar"></div>
    </main>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const productsContainer = document.getElementById("products-container");

        // Fetch data from the local JSON file
        fetch("products.json")
          .then((response) => response.json())
          .then((data) => {
            const strutopCategory = data.categories.find((category) => category.name === "strutop");

            if (strutopCategory) {
              // Display products in the "strutop" category
              strutopCategory.products.forEach((product) => {
                const productDiv = document.createElement("div");
                productDiv.classList.add("product");

                const productImage = document.createElement("img");
                productImage.src = `../assets/img/${product.image}`;
                productImage.alt = product.name.en;

                const productNameDiv = document.createElement("div");
                productNameDiv.classList.add("product-name");

                const productNameEn = document.createElement("h3");
                productNameEn.textContent = product.name.en;

                const productNameFa = document.createElement("h3");
                productNameFa.textContent = product.name.fa;

                productNameDiv.appendChild(productNameEn);
                productNameDiv.appendChild(productNameFa);

                productDiv.appendChild(productNameDiv);
                productDiv.appendChild(productImage);

                productsContainer.appendChild(productDiv);
              });
            } else {
              console.error('Category "strutop" not found in the data.');
            }
          })
          .catch((error) => {
            console.error("Error fetching product data:", error);
          });
      });
      const draggableSection = document.querySelector(".otherProduct .category");
      let isDragging = false;
      let startX;
      draggableSection.addEventListener("mousedown", (e) => {
        isDragging = true;
        startX = e.pageX - draggableSection.getBoundingClientRect().left;
        draggableSection.style.cursor = "grabbing";
      });

      document.addEventListener("mousemove", (e) => {
        if (!isDragging) return;

        const x = startX - e.pageX;
        console.log(x, e.pageX, startX);

        if (x > 0) {
          draggableSection.style.transform = `translateX(0)`;
        } else if (Math.abs(x) > draggableSection.scrollWidth - window.innerWidth) {
          draggableSection.style.transform = `translateX(${
            +draggableSection.scrollWidth - window.innerWidth
          }px)`;
        } else {
          draggableSection.style.transform = `translateX(${-x}px)`;
        }
      });

      document.addEventListener("mouseup", () => {
        isDragging = false;
        draggableSection.style.cursor = "grab";
      });
    </script>
  </body>
</html>
